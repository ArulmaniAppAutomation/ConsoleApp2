{
  "AppAutomationMenuItem": "Apps",
  "AppAutomationCaseName": "Win32AppTest",
  "AppAutomationType": "Windows app (Win32)",
  "Type": "AppAutomation",
  "Name": "Manually configure Requirement rules",
  "Scenarios": [
    {
      "Name": "Go to App page and create Windows app(Win32) apps",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "GoToMainPageAsync"
            },
            {
              "ControlType": "ClickAddButtonAsync"
            }
          ]
        }
      ]
    },
    {
      "Name": "Select app type",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.PopUp.SelectAppTypeUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "SelectAppTypeAsync",
              "OperationValue": "Windows app (Win32)"
            }
          ]
        }
      ]
    },
    {
      "Name": "App information select app package file",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "ClickSelectAppPackageFileButtonAsync"
            }
          ]
        }
      ]
    },
    {
      "Name": "App information select app package file",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.PopUp.UploadFileUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "UploadFile",
              "OperationValue": "AppAutomation\\MicrosoftProductStudio.intunewin"
            },
            {
              "ControlType": "ClickOKButtonAsync"
            }
          ]
        }
      ]
    },
    {
      "Name": "App information set app information",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "SetAppInformationNameAsync",
              "OperationValue": "25533644Generated from TestCaseName"
            },
            {
              "ControlType": "SetAppInformationDescriptionAsync",
              "OperationValue": "UI Automation testing"
            },
            {
              "ControlType": "SetAppInformationPublisherAsync",
              "OperationValue": "Win32AppLifeEx"
            },
            {
              "ControlType": "ClickNextButtonAsync"
            }
          ]
        }
      ]
    },
    {
      "Name": "App information set Program",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "ClickNextButtonAsync"
            }
          ]
        }
      ]
    },
    {
      "Name": "App information set Requirements",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "SetOperationSystemArchitectureAsync",
              "Value": [ "64-bit" ]
            },
            {
              "ControlType": "SetMinimumOperationSystemAsync",
              "Value": [ "Windows 10 1709" ]
            },
            {
              "ControlType": "SetDiskSpaceRequiredAsync",
              "OperationValue": "10"
            },
            {
              "ControlType": "SetPhysicalMemoryRequiredAsync",
              "OperationValue": "30"
            },
            {
              "ControlType": "SetMinimumNumberOfLogicalProcessorsRequiredAsync",
              "OperationValue": "1"
            },
            {
              "ControlType": "SetMinimumCPUSpeedRequiredAsync",
              "OperationValue": "60"
            },

            {
              "ControlType": "ClickRequirementAddButtonAsync"
            },
            {
              "ControlType": "SelectRequirementTypeAsync",
              "OperationValue": "Script"
            },
            {
              "ControlType": "SetRuleScriptFileAsync",
              "OperationValue": "AppAutomation\\detect.ps1"
            },
            {
              "ControlType": "SetRuleRunScriptAs32BitProcessOn64BitClientsAsync",
              "OperationValue": "Yes"
            },
            {
              "ControlType": "SetRuleSelectOutputDataTypeAsync",
              "OperationValue": "Date and Time"
            },
            {
              "ControlType": "SetRuleOperatorAsync",
              "OperationValue": "Equals"
            },
            {
              "ControlType": "SetRuleDateTimeValueAsync",
              "OperationValue": "2018-09-03"
            },
            {
              "ControlType": "ClickDetectionRuleOKButtonAsync"
            },



            {
              "ControlType": "ClickRequirementAddButtonAsync"
            },
            {
              "ControlType": "SelectRequirementTypeAsync",
              "OperationValue": "File"
            },
            {
              "ControlType": "SetRulePathAsync",
              "OperationValue": "C:\\Program Files"
            },
            {
              "ControlType": "SetRuleFileOrFolderAsync",
              "OperationValue": "test.txt"
            },
            {
              "ControlType": "SetRulePropertyAsync",
              "OperationValue": "File or folder does not exist"
            },
            {
              "ControlType": "ClickDetectionRuleOKButtonAsync"
            },
            {
              "ControlType": "ClickRequirementAddButtonAsync"
            },
            {
              "ControlType": "SelectRequirementTypeAsync",
              "OperationValue": "File"
            },
            {
              "ControlType": "SetRulePathAsync",
              "OperationValue": "C:\\Program Files"
            },
            {
              "ControlType": "SetRuleFileOrFolderAsync",
              "OperationValue": "test.txt"
            },
            {
              "ControlType": "SetRulePropertyAsync",
              "OperationValue": "Date modified"
            },
            {
              "ControlType": "SetRuleOperatorAsync",
              "OperationValue": "Greater than"
            },
            {
              "ControlType": "SetRuleDateTimeValueAsync",
              "OperationValue": "2018-09-03"
            },
            {
              "ControlType": "ClickDetectionRuleOKButtonAsync"
            },
            {
              "ControlType": "ClickRequirementAddButtonAsync"
            },
            {
              "ControlType": "SelectRequirementTypeAsync",
              "OperationValue": "Registry"
            },
            {
              "ControlType": "SetRuleKeyPathAsync",
              "OperationValue": "HKEY_LOCAL_MACHINE\\SOFTWARE\\Test"
            },
            {
              "ControlType": "SetRuleValueNameAsync",
              "OperationValue": "test"
            },
            {
              "ControlType": "SetRuleRegistryKeyRequirementAsync",
              "OperationValue": "String comparison"
            },
            {
              "ControlType": "SetRuleOperatorAsync",
              "OperationValue": "Equals"
            },
            {
              "ControlType": "SetRuleValueAsync",
              "OperationValue": "1.0"
            },
            {
              "ControlType": "ClickDetectionRuleOKButtonAsync"
            },

            {
              "ControlType": "ClickNextButtonAsync"
            }
          ]
        }
      ]
    },
    {
      "Name": "App information set Detection rules",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "SetRulesFormatAsync",
              "OperationValue": "Use a custom detection script"
            },
            {
              "ControlType": "SelectScriptFileAsync",
              "OperationValue": "AppAutomation\\detect.ps1"
            },
            {
              "ControlType": "SetRunScriptAs32BitProcessOn64BitClientsAsync",
              "OperationValue": "Yes"
            },
            {
              "ControlType": "SetEnforceScriptSignatureCheckAndRunScriptSilentlyAsync",
              "OperationValue": "Yes"
            },
            {
              "ControlType": "ClickNextButtonAsync"
            }
          ]
        }
      ]
    },
    {
      "Name": "App information set Dependencies",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "ClickDependenciesAddButtonAsync"
            },
            {
              "ControlType": "InitAppAutomationAPPDependency"
            },
            {
              "ControlType": "SelectDependencyAppsAsync",
              "Value": [ "2G - SCCM Test App - Simple", "No" ]
            },
            {
              "ControlType": "SuccessAppAutomationAPPDependency"
            },
            {
              "ControlType": "ClickNextButtonAsync"
            }
          ]
        }
      ]
    },
    {
      "Name": "App information set Supersedence",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "ClickNextButtonAsync"
            }
          ]
        }
      ]
    },
    {
      "Name": "App information set Assignments",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "InitAppAutomationAppAssignment"
            },
            {
              "ControlType": "ClickRequiredAddAllDevicesAsync"
            },
            {
              "ControlType": "ClickRequiredAllDevicesFilterModeAsync"
            }
          ]
        }
      ]
    },
    {
      "Name": "App information set Assignments group filter",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.PopUp.AssignmentGroupFilterUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "SelectBehaveAsync",
              "OperationValue": "Exclude filtered devices in assignment"
            },
            {
              "ControlType": "SelectSpecialFilterAsync",
              "OperationValue": "Exclude"
            }
          ]
        }
      ]
    },
    {
      "Name": "App information set Assignments",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "MarkAssignmentsCompleteAsync"
            },
            {
              "ControlType": "ClickNextButtonAsync"
            }
          ]
        }
      ]
    },
    {
      "Name": "App information Review",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "ClickCreateButtonAsync"
            }
          ]
        }
      ]
    },
    {
      "Name": "App Verify",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "initAppAutomationVerifyResult"
            },
            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [ "Name", "25533644Generated from TestCaseName" ]
            },
            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [ "Publisher", "Win32AppLifeEx" ]
            },
            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [ "Operating system architecture", "x64" ]
            },
            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [
                "Minimum operating system",
                "Windows 10 1709"
              ]
            },

            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [ "Disk space required (MB)", "10" ]
            },
            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [ "Physical memory required (MB)", "30" ]
            },
            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [ "Minimum number of logical processors required", "1" ]
            },
            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [ "Minimum CPU speed required (MHz)", "60" ]
            },
            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [ "Dependencies", "2G - SCCM Test App - Simple" ]
            },
            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [
                "Additional requirement rules",
                "Script detect.ps1"
              ]
            },
            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [
                "Additional requirement rules",
                "Program Files"
              ]
            },
            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [
                "Additional requirement rules",
                "HKEY_LOCAL_MACHINE"
              ]
            },
            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [
                "Rules format",
                "Use a custom detection script"
              ]
            },
            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [
                "Run script as 32-bit process on 64-bit clients",
                "Yes"
              ]
            },
            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [
                "Enforce script signature check and run script silently",
                "Yes"
              ]
            },
            {
              "ControlType": "VerifyPropertyAssignmentsAsync",
              "Value": [ "Required", "All devices" ]
            }
          ]
        }
      ]
    },
    {
      "Name": "App information Dependency update",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "InitAppAutomationAPPDependency"
            },
            {
              "ControlType": "ClickDependenciesEditButtonAsync"
            },
            {
              "ControlType": "DeleteDependenciesAppsAsync",
              "OperationValue": "2G - SCCM Test App - Simple"
            },
            {
              "ControlType": "ClickDependenciesAddButtonAsync"
            },
            {
              "ControlType": "SelectDependencyAppsAsync",
              "Value": [ "npp.7.5.7.Installer.intunewin", "No" ]
            },
            {
              "ControlType": "ClickDependenciesAddButtonAsync"
            },
            {
              "ControlType": "SelectDependencyAppsAsync",
              "Value": [ "Orca", "Yes" ]
            },
            {
              "ControlType": "ClickReviewSaveButtonAsync"
            },
            {
              "ControlType": "ClickReviewSaveButtonAsync"
            },
            {
              "ControlType": "ClickSaveButtonAsync"
            },
            {
              "ControlType": "SuccessAppAutomationAPPDependency"
            }
          ]
        }
      ]
    },
    {
      "Name": "App information Dependency Verify",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "InitAppAutomationAppUpdated"
            },
            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [ "Dependencies", "npp.7.5.7.Installer.intunewin" ]
            },
            {
              "ControlType": "VerifyPropertyAsync",
              "Value": [ "Dependencies", "Orca" ]
            },
            {
              "ControlType": "SuccessAppAutomationAppUpdated"
            }
          ]
        }
      ]
    },
    {
      "Name": "App Dependency Delete",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
      "Steps": [
        {
          "Preparation": [
            {
              "ControlType": "ClickDependenciesEditButtonAsync"
            },
            {
              "ControlType": "DeleteDependenciesAppsAsync",
              "OperationValue": "npp.7.5.7.Installer.intunewin"
            },
            {
              "ControlType": "DeleteDependenciesAppsAsync",
              "OperationValue": "Orca"
            },
            {
              "ControlType": "ClickReviewSaveButtonAsync"
            },
            {
              "ControlType": "ClickReviewSaveButtonAsync"
            },
            {
              "ControlType": "ClickSaveButtonAsync"
            }
          ]
        }
      ]
    },
    {
      "Name": "App Install status Verify",
      "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
      "Steps": [
        {
          "Preparation": [
              {
                "ControlType": "VerifyDeviceInstallStatusAsync"
              },
              {
                "ControlType": "VerifyUserInstallStatusAsync"
              },
              {
                "ControlType": "VerifyMonitorAppInstallStatusAsync"
              },
              {
                "ControlType": "SuccessAppAutomationVerifyResult"
              }
          ]
        }
      ]
    },
    {
        "Name": "App Delete",
        "UtilsName": "PlaywrightTests.Common.Utils.BaseUtils.Apps.ByPlatform.AllAppsUtils",
        "Steps": [
          {
            "Preparation": [
              {
                "ControlType": "GoToMainPageAsync"
              },
              {
                "ControlType": "DeleteAppByNameAsync"
              }
            ]
          }
        ]
    }
  ]
}
